# 댐 유입 수량 예측을 통한 최적의 수량 예측 모형 도출

## 소개
본 프로젝트는 2021 박콘테스트에 제출한 프로젝트입니다. 
저는 본 프로젝트에서 데이터 전처리, 모델링, 실험을 맡았습니다. 
본 프로젝트의 목적은 댐 유입 수량 예측을 위한 최적의 모델을 제출하는 것입니다. 
하나의 Target에 대하여 6개의 독립적인 데이터 집단이 주어져 데이터 집단을 효율적으로 활용하는 것이 중요했고, 변수로 K-댐 주변 지역의 유역평균강수, 강우량, 수위가 주어져 변수 간의 다중공선성이 발생하여 모든 변수를 효과적으로 활용하는 것이 중요했습니다. 
따라서 본 프로젝트에서는 End-to-End 과정으로 변수와 독립적인 데이터 집단 간의 결합을 효과적, 효율적으로 학습할 수 있는 방법을 찾고자 노력했습니다.

## 내용
- 독립적인 데이터 집단 6개가 존재하여, 데이터 집단 간의 결합을 효율적으로 학습하는 것이 필요
    - 각 데이터 집단마다 Model을 만들어 Ensemble 하는 방식 
    (모델의 개수 == 데이터 집단의 개수)
    - 각 데이터 집단을 하나의 변수로 생각하여 하나의 Model을 만드는 방식 
    (전체 변수의 개수 == 데이터 집단의 개수 * 개별 변수의 개수)
    - 데이터 집단 간의 결합을 End-to-End로 학습할 수 있는 CNN 모델 구상
- 데이터 변수 간의 강한 상관 관계가 존재하여, 모든 변수를 효과적으로 활용하는 것이 어려움
    - ML Model의 경우 변수 간의 강한 상관 관계가 존재하여, 편향적인 변수 활용을 보여줌
    - 모든 변수를 효과적으로 활용하고자 DNN 기반의 접근법 구상
- 변수와 데이터 집단 간의 상호작용을 효율적, 효과적으로 학습할 수 있도록 WaveNet을 변형한 CNN 모델을 구상함
    - 변수 간의 상호작용을 Filter의 연산으로 표현
    - 각 채널을 데이터 집단으로 구성하여, 집단 간의 결합을 Feature Map의 결합으로 표현
    - WaveNet의 Dilated Convolution을 활용하여 멀리 있는 변수와의 상호작용도 효율적으로 학습할 수 있도록 구성
- ML 모델과 WaveNet을 변형한 CNN 모델을 만들어 서로의 성능을 비교하며 최적의 모델을 찾음
- End-to-End 과정으로 변수와 데이터 집단 간의 상호작용을 효과적, 효율적으로 학습하는 WaveNet을 변형한 CNN1D 모델을 최종 모델로 제안함
- CNN1D 모델의 경우 모든 변수와 데이터 집단을 조화롭게 활용하기 때문에 ML 기반의 모델 중 가장 성능이 좋았던 XGBoost 모델보다 관측 오류에 더 강건하다는 것이 실험을 통해서 확인함
- 본 모델은 현업에서 발생하는 국지성 호우로 인한 관측 오류 문제를 해결하는데 기여할 수 있음
- **[분석 코드](https://github.com/SeongBeomLEE/Project/blob/main/2021_bigcontest/%EB%B6%84%EC%84%9D%20%EC%BD%94%EB%93%9C.ipynb)**
- **[최종 보고서](https://github.com/SeongBeomLEE/Project/blob/main/2021_bigcontest/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B6%84%EC%84%9D%EB%B6%84%EC%95%BC_%ED%93%A8%EC%B2%98%EC%8A%A4%EB%A6%AC%EA%B7%B8_%ED%99%8D%EC%88%98ZERO_%EB%B2%94%ED%98%B8_%EA%B2%B0%EA%B3%BC%EB%B3%B4%EA%B3%A0%EC%84%9C.pdf)**

## 아쉬운 점
- 독립적인 데이터 집단의 결합과 변수간의 상호작용을 효과적으로 학습할 수 있는 방법을 고려한 점은 좋았으나 CNN 모델을 고집한 것이 제일 아쉬움
- CNN에서 Filter는 각 변수마다 동일한 값을 공유하기 때문에 변수 간의 상호작용을 효과적으로 학습할 수 있다는 보장이 없음
- CNN에 데이터 집단의 결합방식과 함께 변수 간의 상호작용을 학습할 수 있는 다른 모델을 고려했다면 더 좋은 결과를 가져왔을 것이라고 생각됨